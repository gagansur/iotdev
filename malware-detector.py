#!/usr/bin/env python
import sys
import re
import smtplib
import base64

sender0 = 'gagansur@gmail.com'
pwd0 = 'Euchemist@1'
receiver0= 'gks007@shsu.com'

def send_email(text):
    sender = 'gagansur@gmail.com'
    receivers = ['gagansur@gmail.com', 'jassysur@gmail.com']

    try:
       mail = smtplib.SMTP_SSL("smtp.gmail.com", 465)
       mail.login(sender0, pwd0)
       message = 'possible private content transferred{0}'.format(text)
       mail.sendmail("gagansur@gmail.com", "gagansur@gmail.com", message)
       mail.quit()
       print "Successfully sent email"
    except SMTPException:
       print "Error: unable to send email"

def write_file(text):
    with open('captured_data.txt', 'a') as the_file:
        the_file.write(text+"\n")# use stdin if it's full                                                        

if not sys.stdin.isatty():
    input_stream = sys.stdin
    for line in input_stream:
        print(line)
        result1 = re.search("^.*humidity\s*\d*[.]{1}\d*\s*temperature\s*\d*[.]{1}\d*\s*", line)
        if result1 is not None:
            print (line +": is valid data")
        else:
            print (line +(": is possible hack..."))
            print ("sending email to gagansur@gmail.com")
            write_file(line)
            #send_email(line)
